<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <!-- Global Fonts -->
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Roboto:ital,wght@0,100;0,300;0,400;0,500;0,700;0,900;1,100;1,300;1,400;1,500;1,700;1,900&display=swap" rel="stylesheet">
  <!-- Font Awesome Link -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.1.2/css/all.min.css" integrity="sha512-1sCRPdkRXhBV2PBLUdRb4tMg1w2YPf37qatUFeS7zlBy7jJI8Lf4VHwWfZZfpXtYSLy85pkm9GaYVYMfw5BC1A==" crossorigin="anonymous" referrerpolicy="no-referrer" />
  <link rel="stylesheet" href="style.css">
    <title>Currency Convert</title>
</head>
<body>
  <h1 id="heading">AED TO PKR</h1>

  <div class="container">

    <div class="select">
      <select id="selectbox"></select>

      <select id="selectbox2"></select>

      <input type="number" placeholder="1" id="amount">

      <button onclick=setValue()>Set Value</button>

      <h3 id="h3"></h3>
    </div>


  </div>


    <script>
      const selectbox = document.getElementById('selectbox');
      const selectbox2 = document.getElementById('selectbox2');
      getSymbols()

      async function getSymbols(){
        const response = await fetch('https://api.exchangerate.host/symbols?format=csv');
        const data = await response.text();
        const table = data.split(/\n/).slice(1, 171);
        table.forEach(row =>{
          const col = row.split(/,/);
          const year = document.createElement('option')
          value = col[1];
          year.value = value.slice(1,4);
          year.innerText = value.slice(1,4);
          const year2 = document.createElement('option')
          year2.value = value.slice(1,4);
          year2.innerText = value.slice(1,4);
          selectbox.appendChild(year);
          selectbox2.appendChild(year2);
        });
      }


      
      const fromInput = document.getElementById('selectbox');
      const toInput = document.getElementById('selectbox2');
      const amountInput = document.getElementById('amount');


      function setValue(){
        let fromCurr = fromInput.value;
        let toCurr = toInput.value;
        let amount = amountInput.value;

        let requestURL = `https://api.exchangerate.host/convert?from=${fromCurr}&to=${toCurr}&amount=${amount}`;
        let request = new XMLHttpRequest();
        request.open('GET', requestURL, amount=1200);
        request.responseType = 'json';
        request.send();

        request.onload = function() {
          const h3 = document.getElementById('h3');
          const head = document.getElementById('heading');
          head.innerText = fromCurr + " TO " + toCurr;
          let response = request.response;
          h3.innerText = (Math.floor(parseFloat(response.result)*100)/100);
      }
      }
            
    </script>
</body>
</html>